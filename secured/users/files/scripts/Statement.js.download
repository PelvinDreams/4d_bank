function Statement(t){function e(t){t.preventDefault();var e=$(t.target).data("from"),n=$(t.target).data("until");$("#statement-form input[name=from]").val(e),$("#statement-form input[name=until]").val(n),u(!1)}function n(){$("#advanced-options").toggle();var t=$("#advanced-options").is(":visible");$("#advanced-options input").prop("disabled",!t),$("#query-turnovers-button").prop("disabled",t),h.updateExportStatementUrls(),p()}function a(){var t=$(this);t.attr("action",t.attr("action")+"?from="+$("#statement-form input[name=from]").val()+"&until="+$("#statement-form input[name=until]").val())}function o(){$("#single-account, #multiple-accounts, #show-closed-accounts").slideToggle().find("select").prop("disabled",!0),$("#multiple-accounts").find("input[type=checkbox]").prop("disabled",!1)}function i(){var t=$.fx.off;try{$.fx.off=!0,o()}finally{$.fx.off=t}}function r(){var t=$(this).is(":checked");$("input[name=accountId],input.account-group").prop("checked",t)}function c(t,e){if(!$(t.target).prop("disabled")){var n=$("#"+e);n.find("[name=txId]").remove(),$(".statement input[name=txId]:checked").each(function(){$('<input type="hidden" name="txId" value="'+$(this).val()+'">').appendTo(n)}),n.submit()}}function l(t){if("pdf"==t){var e=($("#btn-export-pdf").attr("href"),"ascending"),n=$(".headerSortUp").data("column");n&&(e="descending"),n||(n=$(".headerSortDown").data("column"))}$("input[name=sortBy]").val(n||""),$("input[name=sortOrder]").val(e||"")}function s(){var t=$("input[name=detailed]").is(":checked");$("#filter-vatin").prop("disabled",!t).parent("label").toggle(t),$("#filter-bic").prop("disabled",!t).parent("label").toggle(t)}function d(){var t=$("input[name=compact]").is(":checked");$("input[name=detailed]").prop("checked",!t),s()}function u(t){var e=$("#statement-form");return e.find("input[name=turnovers]").val(t),e.find("input[name=format]").val(""),e.removeClass("no-disable-on-submit"),e.attr("target","_self"),e.submit(),p(),!1}function m(){var t=$("[name=accountId]:checked").length>0;$(".form-actions .btn").enable(t).toggleClass("disabled",!t)}function f(t){var e=$("#statement-form"),n=$(this).data("format");return l(n),e.find("input[name=format]").val(n),e.find("input[name=offline]").is(":checked")?($("#offline-statements-overview").find(".alert-error,.alert-warning").remove(),$("#offline-statements-overview").find("#loading-icon").show(),$.post(e.attr("action"),e.serialize(),function(t){e.find("input[name=offline]").prop("checked",!1).prop("disabled",!0),$("#offline-statements-overview").replaceWith(t),$("#statement-export .dropdown-toggle").dropdown("toggle")})):(e.attr("target","_blank"),e.addClass("no-loader").addClass("no-disable-on-submit").submit()),!1}function p(){var t=$("#statement-email-send button");if(t.length&&b()){var e="true"===$("#statement-form").find('input[name="turnovers"]').val(),n=$("#advanced-options").is(":visible");t.prop("disabled",e||n)}}function b(){if($("#composite-customer-accounts").length)return $("#composite-customer-accounts").val();var t=$('select[name="accountId"]');return t.is(":visible")?t.val():$('input[name="accountId"]:checked').length}var v=t.isAdvancedFilterUsed,h=this;this.updateExportStatementUrls=function(){var t=$("#statement-form"),e=t.attr("action")+"?"+t.serialize();$("#statement-form #btn-export-xls").attr("href",e),$("#statement-form #btn-export-1c").attr("href",e),$("#statement-form #btn-export-pdf").attr("href",e),$("#statement-form #btn-export-dbf").attr("href",e)},this.init=function(){$(".preset-date-period").on("click",e),$("select[name=accountId]").on("change",u),$("#query-button").click(u),$("#query-turnovers-button").click(function(){u(!0)}),$("#statement-export .export-btn").on("click",f),$("input[name=compact]").change(d),d(),$("#statement-form").on("submit",a),$("#statement-form").on("change","input,select",h.updateExportStatementUrls),$("#statement-form").on("click","[name=showClosedAccounts]",u),$("#toggle-advanced-options").on("click",n),v&&n(),$("#statement-form .date").datepicker({startDate:t.startDate,endDate:t.endDate}),$("#statement-form #from-date").on("changeDate",function(t){$("#statement-form #until-date").datepicker("setStartDate",t.date)}),$("#statement-form #until-date").on("changeDate",function(t){$("#statement-form #from-date").datepicker("setEndDate",t.date)}),$("#select-multiple-accounts").on("click",o),t.multipleAccountsSelected&&i(),$("#select-all-accounts").on("click",r),$(".toggle-all-transactions").click(function(){$("#statement-"+$(this).data("account")+" table.statement tbody tr:visible input[name=txId]").prop("checked",$(this).is(":checked"))}),$(".statement input[name=txId], .toggle-all-transactions").click(function(){var e=$("table.statement tbody tr:visible input[name=txId]:checked").length;$("#btn-export-pdf, #window-print, #btn-export-xls, #btn-export-1c, #btn-export-dbf").toggleClass("hidden",!!e),$("#btn-bulk-print").toggleClass("hidden",!e).prop("disabled",e>t.bulkPrintLimit).prop("disabled",e>t.bulkPrintLimit).find(".count").text(" ("+e+")"),$("#btn-bulk-pdf").toggleClass("hidden",!e).prop("disabled",e>t.bulkPDFLimit).prop("disabled",e>t.bulkPDFLimit).find(".count").text(" ("+e+")")}),$("#btn-bulk-print").on("click",function(t){c(t,"bulk-print-form")}),$("#btn-bulk-pdf").on("click",function(t){c(t,"bulk-pdf-form")}),$("[name=accountId]").on("change",m),$("#offline").on("click",function(){var t=$(this).find("[type=checkbox]").is(":checked");$("#btn-export-pdf").parent().toggle(!t)}),$("#composite-customer-accounts").length&&$("#composite-customer-accounts").on("compositeAccountsChange",function(){p()}),$("#statement-page").on("click",".delete-offline-statement",function(e){function n(){window.location.reload()}function a(){$.post(o,{fileId:i,authenticityToken:t.authenticityToken},n)}e.preventDefault();var o=$(this).attr("href"),i=$(this).data("file-id");return $.confirm({title:t.textDelete,text:t.textOfflineDelete,confirm:a}),!1}),h.updateExportStatementUrls(),$(".email-btn").on("click",function(){return $('input[name="format"]').val($(this).data("format")),$("#statement-to-email-container").modal(),!1}),p()}}